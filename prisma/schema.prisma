generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Equipe {
  id         Int      @id @default(autoincrement())
  nom        String
  role       String
  telephone  String?
  email      String?  @unique
  motDePasse String?
  createdAt  DateTime @default(now())
}

model Appartement {
  id          Int     @id @default(autoincrement())
  code        String  @unique
  nom         String
  ville       String
  pays        String
  adresse     String
  description String?
  lat         Float?
  lng         Float?

  wifiSsid     String?
  wifiPassword String?

  keyboxPlace String?
  keyboxCode  String?

  equipements        String?
  videosExplicatives String?
  regles             String?

  proprietaireNom   String?
  proprietaireTel   String?
  proprietaireEmail String?

  imagePrincipale   String?
  imagesSecondaires String?

  contratUrl String?

  createdAt DateTime @default(now())

  avis         Avis[]
  services     Service[]
  reservations Reservation[]

  // relation via code pour Check-In
  checkinsByCode CheckIn[] @relation("AppartByCode")
}

model CheckIn {
  id          String   @id @default(cuid())
  nom         String
  accepted    Boolean
  signature   String
  passportUrl String?
  createdAt   DateTime @default(now())

  appartement     Appartement? @relation("AppartByCode", fields: [appartementCode], references: [code])
  appartementCode String?
}

model Service {
  id              Int      @id @default(autoincrement())
  nom             String
  whatsappMessage String?
  statut          String   @default("en_attente")
  date            DateTime @default(now())

  appartementId Int?
  appartement   Appartement? @relation(fields: [appartementId], references: [id])
}






model Avis {
  id            Int      @id @default(autoincrement())
  appartementId Int?
  nom           String
  note          Int
  commentaire   String
  date          DateTime @default(now())
  visible       Boolean  @default(true)

  appartement Appartement? @relation(fields: [appartementId], references: [id])
}

model localContent {
  id        Int     @id @default(autoincrement())
  ville     String
  categorie String
  nom       String
  adresse   String?
  lat       Float?
  lng       Float?
  type      String?
  horaire   String?
  image     String?
}





model Subscription {
  id           Int       @id @default(autoincrement())
  proprietaire String
  pack         String
  statut       String
  debut        DateTime?
  fin          DateTime?
  factures     Json?
  createdAt    DateTime  @default(now())
}

model Local {
  id          Int      @id @default(autoincrement())
  nom         String
  type        String
  adresse     String?
  telephone   String?
  description String?
  createdAt   DateTime @default(now())
}

model Abonnement {
  id             Int      @id @default(autoincrement())
  pack           String
  statut         String
  renouvellement DateTime
  facturesPayees Int      @default(0)
  createdAt      DateTime @default(now())
}

model playing_with_neon {
  id    Int    @id @default(autoincrement())
  name  String
  value Float? @db.Real
}

model Reservation {
  id          Int      @id @default(autoincrement())
  clientNom   String
  clientEmail String?
  clientTel   String?
  debut       DateTime
  fin         DateTime
  statut      String   @default("confirm√©e")
  createdAt   DateTime @default(now())

  appartementId Int
  appartement   Appartement @relation(fields: [appartementId], references: [id])
}
